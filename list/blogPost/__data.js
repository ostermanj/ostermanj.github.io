window.__sveltekit_data = (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag){m.metadata={tags:[],concepts:[]};m.sys={space:{sys:{type:a,linkType:b,id:c}},id:"6rhv4yMoAF3cN8jyYqZSWu",type:g,createdAt:"2022-06-17T16:18:02.488Z",updatedAt:"2022-06-25T01:07:29.101Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:u,revision:j,contentType:{sys:{type:a,linkType:h,id:"author"}},locale:f};m.fields={fullName:"John Osterman",website:"https:\u002F\u002Fosterman.io\u002F",twitterAccount:"https:\u002F\u002Ftwitter.com\u002FJohnAOsterman",linkedinAccount:"https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fjohn-osterman-32714012\u002F",photo:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"6E2Gh0TS2hrqafgOY1NlHr",type:l,createdAt:C,updatedAt:C,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:s,revision:i,locale:f},fields:{title:"john osterman photo",description:o,file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F6E2Gh0TS2hrqafgOY1NlHr\u002F68804563485dfdb3f0cb50fb38e3e3fa\u002Fosterman-photo.jpg",details:{size:256400,image:{width:750,height:847}},fileName:"osterman-photo.jpg",contentType:t}}}};w.metadata={tags:[],concepts:[]};w.sys={space:{sys:{type:a,linkType:b,id:c}},id:"3AIjGHsEBIU2L5LSAhDYZG",type:g,createdAt:W,updatedAt:W,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f};w.fields={tag:"dataviz"};D.metadata={tags:[],concepts:[]};D.sys={space:{sys:{type:a,linkType:b,id:c}},id:"7bxk7hUPon7KmLkEmjxXjD",type:g,createdAt:E,updatedAt:E,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f};D.fields={tag:"HTML"};F.metadata={tags:[],concepts:[]};F.sys={space:{sys:{type:a,linkType:b,id:c}},id:"cNdrt61TxmpGdCVqJVNYj",type:g,createdAt:G,updatedAt:G,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f};F.fields={tag:"CSS"};S.metadata={tags:[],concepts:[]};S.sys={space:{sys:{type:a,linkType:b,id:c}},id:"3Z8ov12craUSFU6doWqj5b",type:g,createdAt:T,updatedAt:T,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:q,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f};S.fields={tag:"things I look up all the time"};X.metadata={tags:[],concepts:[]};X.sys={space:{sys:{type:a,linkType:b,id:c}},id:"5tPE4sus2igTIK2zIdqyBz",type:g,createdAt:Y,updatedAt:Y,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f};X.fields={tag:"mapbox"};aa.metadata={tags:[],concepts:[]};aa.sys={space:{sys:{type:a,linkType:b,id:c}},id:"1249mmZmPwsLjWHbXJhgux",type:g,createdAt:ab,updatedAt:ab,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f};aa.fields={tag:"content"};return {type:A,nodes:[B,B,{type:A,data:{type:k,items:[{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"2nuEmV2KmDxbfRjMoUJbJm",type:g,createdAt:"2024-01-02T16:09:56.795Z",updatedAt:"2024-01-03T14:42:43.006Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:133,revision:15,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"2023 in Review: Embracing Subgrid, \u003Cdialog\u003E, and Container Queries",subtitle:"What's next? Web components, okclh colorspace, and auto image sizes",datePublished:"2024-01-02",body:"Here are some of the features I reached for without hesitation in 2023. It was a good year for front-end web development. Major browsers have been implementing new features at a decent pace, semantic HTML elements with native methods have had some big wins, and CSS is exploding with good new syntax and features. \n\nSome of these are truly new; some are just new to me. \n\n## The dialog element\nOther items on this list may be more exciting, but none saved me as much time or headache as the native HTML `\u003Cdialog\u003E`. Browser support is about 96%, and there is a [polyfill from Google](https:\u002F\u002Fgithub.com\u002FGoogleChrome\u002Fdialog-polyfill) that works if you need to support others. It essentially creates a pop-up with built-in open and close methods. It opens on the top layer and it can be opened as modal, meaning it traps keyboard focus and renders the rest of the document below it inert. It takes a little bit of work to confirm that it's fully accessible, but compared to writing your own JavaScript-heavy component, it's a huge win.\n\nI used it a lot in the redesign of the US Holocaust Memorial Museum's Collections Search detail pages.\n\n\u003Cfigure class=\"half\"\u003E\n\n  ![dialog element](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F3ukp1yUZQgaygtQ9Po4fhQ\u002Ffd12284b5f291102caf81560451f8b38\u002FScreenshot_2023-12-31_at_8.15.35_AM.png)\n  \u003Cfigcaption\u003E\n    A dialog element with form alerts users if their browser is out of date.\n  \u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\nCheck out the [MDN article](https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FHTML\u002FElement\u002Fdialog) on itâ€”there is more to it, including built-in ways to return form data to the main document.\n\n## Container units and container queries   \nNow this one truly is exciting. The features front-end devs had been waiting for finally landed in all browsers in 2023 and is changing how we can design and build components: on the basis of their container's size rather than the container of the whole viewport. [I wrote about it](https:\u002F\u002Fosterman.io\u002Fcontent\u002Fcss-container-queries-are-here\u002F) earlier in the year and won't repeat the details here. I think developers are still discovering all the use cases for container queries and units. As Chris Coyier recently observed, [\"every container queries demo is a card\"](https:\u002F\u002Fchriscoyier.net\u002F2023\u002F12\u002F27\u002Fevery-container-queries-demo-is-a-card\u002F)â€”and indeed that's how I've used them!. Perhaps 2024 will see that expand into new areas.\n\nIn 2023, I put container queries to use in the museum's reimagining of the [History Unfolded](https:\u002F\u002Fnewspapers.ushmm.org\u002F) website and refreshing of the [Experiencing HIstory homepage](https:\u002F\u002Fperspectives.ushmm.org\u002F).\n\n## Summary \u002F details\nThe `\u003Csummary\u003E` and `\u003Cdetails\u003E` elements are not new but they appeared a lot in my work this past year. At base they are a semantic, browser-native way to show and hide text without having to worry about the event handlers or accessibility. The native UI is simple, like this:\n\n\u003Cdetails\u003E\nLorem ipsum dolor sit amet consectetur adipisicing elit. Tenetur reiciendis quas rem corporis animi inventore optio blanditiis nihil rerum dolorem?\n\u003C\u002Fdetails\u003E\n\nWith some CSS and JavaScript flourishes they can be animated and styled however they need to be. I made good use of them in the [Collections Search site](https:\u002F\u002Fcollections.ushmm.org); the refactored [main museum site](https:\u002F\u002Fwww.ushmm.org) uses styled and animated summary \u002F details to pull off the accordion UI of the secondary section navigation menus.\n\n\u003Cfigure\u003E\n\n  ![summary details](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F3L8AOBH8csnamE0erK5OKR\u002F0585e23e93b5216655b06b52b04761a6\u002FScreenshot_2023-12-31_at_8.24.10_AM.png)\n  \u003Cfigcaption\u003E\n    The expandable sections of the museum's secondary navigation components are stylized summary\u002Fdetails elements.\n  \u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\n## Subgrid\nI'd bumped into the use case for subgrid many times before finally wrapping my head around it in 2023. Here's the situation: you have a grid layout to place, say, article summaries across the page. The summaries have a photo, title, short blurb, and call to action link. The main grid layout ensures that the summaries flow in an intrinsically responsive way into rows and columns depending on the screen size. That's nice, but some article titles are one line while others are three; some blurbs are long while others are short. The sections within each article summary (each grid cell) don't line up with each other. It looks off.\n\nI used to mitigate the issue using flexbox to distribute the empty space in each subsection in a balanced way, but without subgrid there is no way (without heavy-handed JavaScript and resize observers) to make the length of one article's blurb affect the space reserved for the others. That's what subgrid does: it allows grid items to have grid tracks that are defined by the parent grid.\n\nCheck out the [MDN subgrid article](https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FCSS\u002FCSS_Grid_Layout\u002FSubgrid) for more. It took me some time to understand that the number of grid tracks for the main grid needs to equal the total number of subtracks. The children of the main grid are then set to span multiple tracks. My initial assumption was that I'd be dividing main tracks into subtracks when in fact it's more like grouping subtracks into main ones.\n\n\u003Cdiv class=\"fx fx-wrap ai-e\"\u003E\n\u003Cfigure class=\"half\"\u003E\n\n  ![cards with subgrid](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F540hhqHTMevmIJuG6AU7cL\u002F083e2e844a6ad1a4a8792b73429d6fd8\u002FScreenshot_2023-12-31_at_8.19.58_AM.png)\n  \u003Cfigcaption\u003E\n    Content cards with subgrid to align the sections of each grid item.\n  \u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\n\u003Cfigure class=\"half\"\u003E\n\n  ![cards without subgrid](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F4hVWlRybr4iXs81cglrDBm\u002F234e420290d422d87025621f8193f877\u002FScreenshot_2023-12-31_at_8.21.59_AM.png)\n  \u003Cfigcaption\u003E\n    Without subgrid, the sections of each grid item are misaligned.\n  \u003C\u002Ffigcaption\u003E\n  \u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\n## My hopes for 2024\nHere are some of the features I hope to use in 2024 that I have not yet\n\n### Web components\nMy work's websites span a number of different tech stacks. The newest is a Nuxt\u002FVue build with Contentful for the headless CMS. There's a Ruby on Rails site and several Laravel sites. We're working to consolidate the design language across sites, which is good, but the code isn't portable from one to another. Web components could help with that. Some of our tech stacks are old enough that using web components might trip things up, but in theory web components would make framework-agnostic elements that we could use across our sites.\n\n### `okclh` colorspace\nBrowser support for `okclh()` is at 88% based on global usage. That's not quite high enough to use without a fallback, but I hope 2024 is the year I get to use it in production, straight up or with a postprocessor. Why? First colorspace can describe colors beyond the typical sRGB gamut, so on hardware that supports a wider gamut you can use `okclh()` to make colors you haven't been able to make before. Second, like `hsl()`, the definition of colors is more intuitive, allowing you to set the lightness, chroma (similar to saturation), and hue of a color in a way that mirrors how we think about color. Unlike `hsl()`, though, the lightness of a color in `okclh()` is perceptually consistent, meaning that colors with the same lightness value will look to us to have the same lightness\u002Fdarkness no matter what hue or chroma they have.\n\n### Auto image sizes\nI wrote earlier in 2023 that auto image sizes, by the attribute `sizes=auto`, will [\"greatly simplify providing the right size native image for the target display size and resolution.\"](https:\u002F\u002Fosterman.io\u002Fcontent\u002Fauto-image-sizes-are-comingrejoice\u002F) At the time, the WHATWG had just adopted the feature in the HTML standard. Since then, the Chrome team has made progress implementing it; from what I can tell, it should be implemented behind an experimental flag in Chrome Canary soon.\n\nCurrently developers have to instruct browsers which image source is the right size\u002Fresolution to choose from a  srcset. That's because browsers need to get the image before the layout is calculated. Lazy-loaded images, however, are fetched after the page layout is rendered, so the browser ought to be able to select the best image source for the current layout, screen resolution, and (I hope)  network conditions without manual intervention. It looks like auto will be the default value, too.\n\nThat, indeed, would make for a very happy new year! ðŸŽ‰ ðŸ¥‚ ",snippet:"Check out the features I reached for in 2023. Major browsers have been implementing new features at a decent pace, semantic HTML elements with native methods have had some big wins, and CSS is exploding with good new syntax and features. ",tags:[D,F],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"1hackdXzGrgpx9GdCXK9ha",type:l,createdAt:H,updatedAt:H,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:v,revision:i,locale:f},fields:{title:"2023 In review",description:o,file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F1hackdXzGrgpx9GdCXK9ha\u002F144e9a5547a9652bb0cecc72702b2b50\u002FDALL_E_Jan_2_Screenshot.png",details:{size:1168025,image:{width:r,height:r}},fileName:"DALLÂ·E Jan 2 Screenshot.png",contentType:p}}},slug:"2023-in-review-embracing-subgrid-less-than-dialog-greater-than-and-container"}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"6pSosx4F3sm8isC5DumoZu",type:g,createdAt:"2023-06-27T01:33:49.886Z",updatedAt:"2023-06-27T12:24:01.276Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:49,revision:v,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"Auto image sizes are comingâ€”rejoice!",datePublished:"2023-06-26",body:"The [WHATWG](https:\u002F\u002Fwhatwg.org\u002F) (Web Hypertext Application Technology Working Group) has updated the HTML standard to include `sizes=\"auto\"` to responsive [images](https:\u002F\u002Fhtml.spec.whatwg.org\u002Fmultipage\u002Fimages.html#attributes-common-to-source-and-img-elements). This does not mean any browser is necessarily working on it yet, let alone on the cusp of shipping it, but I think and hope that it will become part of our everyday syntax. It will greatly simplify providing the right size native image for the target display size and resolution.\n\n## How we do it now\nTo give browsers the info they need to download the correctly sized image, we have to provide them with what size images are available and when to use each of them, based on viewport size. The first part, the what, is specified in the `srcset` attribute of the image; the when is specified in the `sizes` attribute.\n\nHere's an example:\n\n\u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fostermanj\u002F5e7b56d6a62e60bc0d3d9ed5c9e00689\" class=\"embedly-card\" data-card-width=\"100%\" data-card-controls=\"0\"\u003EEmbedded content: https:\u002F\u002Fgist.github.com\u002Fostermanj\u002F5e7b56d6a62e60bc0d3d9ed5c9e00689\u003C\u002Fa\u003E\n\nSee [MDM](https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FAPI\u002FHTMLImageElement\u002Fsrcset) for a fuller description.\n\nThe `sizes` attribute tells the browser how big the display size of the image will be at different viewport widths.  You can specify absolute pixel sizes or relative viewport units, which is nice. But you have to do the calculations and tell the browser which image to download *before it's calculated the page layout* so that image will be ready to display when layout is ready.\n\nThis method is a major limitation if you are using reusable components that will render on the page at sizes that are unknown to you at development time. There's no way to tell the browser which image to download based on container size because it is not knowable until layout is calculated.\n## Lazy load to the rescue\nWhen you use `loading=\"lazy\"`â€”and you should be for many if not most of your imagesâ€”the browser does know what the page layout and display size of the image is before it has to download the file. The browser has to calculate whether the image is in or nearing the viewport before lazily loading it. In this case, there ought to be no reason you have to tell the browser which images to download based on screen sizeâ€”it already knows! That's where `sizes=\"auto\"` comes in. It tells the browser to figure out by itself which image from the `srcset` to use. As it does now, the browser will take the screen resolution into account when making that decision, so you'll automatically get the sharpest image available for the given display size.\n## So when can I use it?\nDunno. It was just [merged into the spec](https:\u002F\u002Fgithub.com\u002Fwhatwg\u002Fhtml\u002Fpull\u002F8008) in early June 2023, and major browsers have expressed interest. I'm hoping for ASAP. I plan on using it as soon as I can.\n",snippet:"Auto sizes for lazy-loaded images will greatly simplify providing the right size native image for the target display size and resolution.",tags:[D],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"ZqG9s8KKHA4g1WEj1z6ol",type:l,createdAt:I,updatedAt:I,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:7,revision:i,locale:f},fields:{title:"Cat image",description:"A Dalle-2 composite of multiple images of the same gray cat",file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002FZqG9s8KKHA4g1WEj1z6ol\u002Fec265b847d6892d29cc287259645980a\u002FDALL__E_2023-06-26_21.22.27_-_A_semi_abstract_illustration_of_a_multiple_photos_of_the_same_gray__cat_with_yellow_eyes__each.png",details:{size:2013060,image:{width:r,height:r}},fileName:"DALLÂ·E 2023-06-26 21.22.27 - A semi abstract illustration of a multiple photos of the same gray  cat with yellow eyes, each a different size..png",contentType:p}}},slug:"auto-image-sizes-are-coming-rejoice"}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"27n0QDqqMFwDxstDwS8qJx",type:g,createdAt:"2023-01-13T01:49:32.802Z",updatedAt:"2023-02-22T21:22:31.999Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:129,revision:J,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"CSS container queries are here!",datePublished:"2023-01-12",dateUpdated:"2023-02-16",body:"\u003Caside class=\"update\"\u003E\n  Support for container queries landed in Firefox on February 13, 2023.\n\u003C\u002Faside\u003E\n\nIt's a good time to be a web developer. The excesses of client-side mania (mea culpa) are giving way to a rediscovery of server-side rendering (which of course never went anywhere). Build-and-deploy services like Vercel, Amplify, Azure Static Web Apps, and a host of others make it easy for small teams or one lone freelancer to set up fully featured websites with edge functions, caching, APIs, and smart image delivery. And with recent advances, especially in CSS, working on the [front of the front end](https:\u002F\u002Fbradfrost.com\u002Fblog\u002Fpost\u002Ffront-of-the-front-end-and-back-of-the-front-end-web-development\u002F) is full of new possibilities and productivity gains.\n\nCSS, it turns out, [really is awesome](https:\u002F\u002Fduckduckgo.com\u002F?t=ffab&q=css+is+awesome&iax=images&ia=images).\n\n## Container queries, finally!\n\nOne of the features I and others have been most eagerly awaiting is container queries. They will make reusing responsive components in different contexts much easier. Grid and flexbox layouts have already lessened the need to use media queries to make layouts responsive to screen size. They are [*intrinsically* responsive](https:\u002F\u002Ftalks.jensimmons.com\u002F15TjNW), wrapping rows and columns based on container size without the need to instruct browsers at exactly what screen width to make the change.\n\nThat's great, but they haven't entirely eliminated my use of media queries. There is still a need to employ them to, for instance, hide an element within a grid at certain screen sizes. Here's a recent example from my work rebuilding the timeline-of-events pages for the [Holocaust Encyclopedia](https:\u002F\u002Fencyclopedia.ushmm.org\u002Fcontent\u002Fen\u002Ftimeline\u002Fholocaust).\n\n\u003Cdiv class=\"fx fx-wrap ai-e\"\u003E\n\u003Cfigure class=\"half\"\u003E\n\n![Timeline events without description shown](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F5c3gZQDg7YwjqWwPNRZybi\u002F34d67b517736ba14d35a77aa1e242f43\u002FScreenshot_2023-01-11_at_8.56.40_AM.png)\n\n \u003Cfigcaption\u003EOn small screens less than 500px wide, no description is shown.\u003C\u002Ffigcaption\u003E\n    \u003C\u002Ffigure\u003E\n\n\u003Cfigure class=\"half\"\u003E\n\n![Timeline event with description shown](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F2zrWLBAT2ahMA0tLtIXEsu\u002F17eab9d573cec6fb7b263f5b092dab57\u002FScreenshot_2023-01-11_at_8.55.12_AM.png)\n\n\u003Cfigcaption\u003EOn screens at least 500px wide, a media query ensures that the description is shown.\u003C\u002Ffigcaption\u003E\n\u003C\u002Ffigure\u003E\n\u003C\u002Fdiv\u003E\n\nThis is the HTML for one of the content cards, each marked up as an `\u003Carticle\u003E`:\n\n\u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fostermanj\u002Fb7b7b55bfb8483e4599dbf82f8690632\" class=\"embedly-card\" data-card-width=\"100%\" data-card-controls=\"0\"\u003EEmbedded content: https:\u002F\u002Fgist.github.com\u002Fostermanj\u002Fb7b7b55bfb8483e4599dbf82f8690632\u003C\u002Fa\u003E\n\nThe CSS makes each event a flexbox with two flex-item children: the container for the image and the container for the text. The relative size of the two children is handled intrinsically using the `flex-grow` css propertyâ€”no need for media queries there.\tBut we wanted to show the description of the event only on screens larger than 500px wide, and that required a media query:\n\n\u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fostermanj\u002F48a62a2cceebab82992e8fb8ce5b3703\" class=\"embedly-card\" data-card-width=\"100%\" data-card-controls=\"0\"\u003EEmbedded content: https:\u002F\u002Fgist.github.com\u002Fostermanj\u002F48a62a2cceebab82992e8fb8ce5b3703\u003C\u002Fa\u003E\n\nWhat that means, though, is that the list of events isn't 100% reusable in other contexts. Say I needed to put the list of events in a sidebar that was 320px wide? If the viewport were at least 500px wide, the event description would show even though the component would be much narrower than the threshold. The logic should be based on the size of the component, not the size of the screen. That's what container queries make possible.\n\n## Simple syntax\n\nThe syntax is pretty simple and builds what we already know from media queries. See the [MDN article](https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FCSS\u002FCSS_Container_Queries) for a full description. \n\nChanging my example to use container queries would only require changing to CSS to declare a containment context on the `article` element, giving it a `container-type` and `container-name` using the `container` shorthand syntax:\n\n\u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fostermanj\u002Fd948427303b301a896bf153b30c934f5\" class=\"embedly-card\" data-card-width=\"100%\" data-card-controls=\"0\"\u003EEmbedded content: https:\u002F\u002Fgist.github.com\u002Fostermanj\u002Fd948427303b301a896bf153b30c934f5\u003C\u002Fa\u003E\n\nAnd then modify the media query from above to be a container query instead:\n\n\u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fostermanj\u002F1fca89adfbd045bb9a9e948b3b157293\" class=\"embedly-card\" data-card-width=\"100%\" data-card-controls=\"0\"\u003EEmbedded content: https:\u002F\u002Fgist.github.com\u002Fostermanj\u002F1fca89adfbd045bb9a9e948b3b157293\u003C\u002Fa\u003E\n\nPretty great! Now displaying or hiding the description depends on the size of the container rather than the viewport. That means the component can be used elsewhere without having to redefine at what screen sizes the description should appear. Code it once and use it everywhere.\n\n## Use them now?\n\nI'll be using container queries from here on out in personal projects soon, I hope, in work projects for production.\n\nContainer queries are landing in browsers and, at the time I'm writing this, have about 75% browser support globally. Firefox, notably, does not yet support them in the stable release but does in the nightly release. Coverage should be good enough now or very soon to use them in a progressive-enhancement sort of way, when you can accept that some browsers won't abide.\n\nThere is a [JavaScript polyfill](https:\u002F\u002Fgithub.com\u002FGoogleChromeLabs\u002Fcontainer-query-polyfill) available that simply works. Please read its docs before using.\n",snippet:"Container queries are coming, and they will make reusing responsive components in different contexts much easier.",tags:[F,{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"4THQ9OOeBdfmo5fzHu6mIr",type:g,createdAt:K,updatedAt:K,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f},fields:{tag:"design"}}],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"fMsWEAYYlWL7oGyXprIjF",type:l,createdAt:L,updatedAt:L,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:9,revision:i,locale:f},fields:{title:"Containers",description:"A large stack of shipping containers on a ship or at harbor.",file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002FfMsWEAYYlWL7oGyXprIjF\u002Fe98ffee9cd68da2575ca39be60aae7cc\u002F15405674883_2c892ea4e2_b.jpg",details:{size:273916,image:{width:r,height:682}},fileName:"15405674883_2c892ea4e2_b.jpg",contentType:t}}},slug:"css-container-queries-are-here"}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"33IWn9KUqHxgH8WIKhKCk1",type:g,createdAt:"2022-08-31T00:26:39.760Z",updatedAt:"2022-08-31T00:56:05.410Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:409,revision:q,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"How to use environment variables in SvelteKit (process.env)",subtitle:"It's easier than it used to be.",datePublished:"2022-08-30",body:"SvelteKit has recently changed how it brings environment variables into your code, whether from a `.env` file or from Node's `process.env`. The new method is better. It allows you to bring private variables (secrets such as API keys) into server-side code without workarounds. Public variables can be imported into client-side code.\n\n\u003Caside class=\"notice\"\u003EAll things SvelteKit are moving very fast and breaking changes are introduced frequently as it moves toward a stable version 1.0 release. Be sure to check out the date this post was publishedâ€”it may get old fast.\u003C\u002Faside\u003E\n\n## How\n\nFour SvelteKit modules are at play to make this happen:\n\n1. [`$env\u002Fdynamic\u002Fpublic`][2]\n2. [`$env\u002Fdynamic\u002Fprivate`][3]\n3. [`$env\u002Fstatic\u002Fpublic`][4]\n4. [`$env\u002Fstatic\u002Fprivate`][5]\n\nThe `dynamic` modules are for variables accessed at runtimeâ€”variables not necessarily known at build time. The `static` modules for variables that can be injected as strings at build time. The `public` modules expose variables that are prefixed by \"PUBLIC_\" or another prefix set in your config file. The `private` modules expose variables not prefixed; trying to import them into client-side code will throw an error. That's to keep you from accidentally exposing secrets to the front end. See the docs for more information.\n\nIn your DEV environment you can supply your public and private variables in a `.env` file. That file shouldn't be committed to source control, especially if it has private variables. In a STAGE or PROD environment you'll want to supply your environment variables through `process.env` by setting variables or secrets directly with your deployment service such as Vercel, Netlify, AWS Amplify, Azure Static Web Apps, or whatever yours is. This site, for instance, is hosted by GitHub Pages; its secrets are saved as repository secrets through the GitHub UI.\n\nThe docs show how to import the variables. For dynamic variables, you import `env` as a named export of the `$env\u002Fdynamic\u002F*` module: `import { dev } from '$env\u002Fdynamic\u002Fpublic';`, for instance. Your variables are properties of the `env` object.\n\nStatic variables are imported directly as named exports from the `$env\u002Fstatic\u002F*` module. This site, for instance, fetches content from [Contentful](https:\u002F\u002Fwww.contentful.com\u002F) during its build process. That requires API keys and other secrets and looks like this:\n\n\u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fostermanj\u002Faaeb966d4de44eb2a0d9e96c27987ce5\" class=\"embedly-card\" data-card-width=\"100%\" data-card-controls=\"0\"\u003EEmbedded content: https:\u002F\u002Fgist.github.com\u002Fostermanj\u002Faaeb966d4de44eb2a0d9e96c27987ce5\u003C\u002Fa\u003E\n\n## The (relatively) old way\n\nThe method outlined above came into being in July 2022, according to [SvelteKit's changelog](https:\u002F\u002Fgithub.com\u002Fsveltejs\u002Fkit\u002Fblob\u002Fmaster\u002Fpackages\u002Fkit\u002FCHANGELOG.md#100-next395). Before that, as best I understand, in  local development SvelteKit was exposing variables loaded by Vite from `.env`, but only variables prefixed with \"VITE_\". There was no straightforward way to import secrets into server-side code. One solution was to install [env-cmd](https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fenv-cmd) and add `env-cmd` to the dev script in `package.json`. That would expose the variables in `.env` to your source code but would make a detour around SvelteKit's failsafe to prevent exposing secrets to the client.\n\n[1]: https:\u002F\u002Fkit.svelte.dev\u002F\n[2]: https:\u002F\u002Fkit.svelte.dev\u002Fdocs\u002Fmodules#$env-dynamic-public\n[3]: https:\u002F\u002Fkit.svelte.dev\u002Fdocs\u002Fmodules#$env-dynamic-private\n[4]: https:\u002F\u002Fkit.svelte.dev\u002Fdocs\u002Fmodules#$env-static-public\n[5]: https:\u002F\u002Fkit.svelte.dev\u002Fdocs\u002Fmodules#$env-static-private",snippet:"SvelteKit has a new way to bring environment variables into your code.",tags:[{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"3Zs1xPdBxUe7FNXmkXO59N",type:g,createdAt:M,updatedAt:M,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f},fields:{tag:"frameworks"}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"5UDGtnFPGejPUdY4ZV8tSH",type:g,createdAt:N,updatedAt:N,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f},fields:{tag:"sveltekit"}}],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"qU1uNTaV2rrFJaT8Mha03",type:l,createdAt:O,updatedAt:O,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:s,revision:i,locale:f},fields:{title:"SvelteKit logo and text",description:o,file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002FqU1uNTaV2rrFJaT8Mha03\u002F28f103dc12c4c15ec79f0e076a992997\u002Fp3nn57r52krvpdieblta.png",details:{size:35878,image:{width:1920,height:1080}},fileName:"p3nn57r52krvpdieblta.png",contentType:p}}},slug:"how-to-use-environment-variables-in-sveltekit-process-env"}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"338kvwSFhcOgbbNjgYpTLi",type:g,createdAt:"2022-06-25T01:18:23.781Z",updatedAt:"2022-08-12T18:19:30.630Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:P,revision:j,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"Easing the pain with continuous deployment",datePublished:"2021-09-24",body:"Getting better at coding, for me, comes in fits and starts. That's true for my command of a language but especially so for my devops set-up. Once I settle on and fine tune a configuration, I tend to stick with for a while. It takes a lot of work to get it right, so the payoff for changing it has to be high.\n\nFor instance: I've been using [Webpack v4][1] to bundle my code for three and a half years. In the meantime version 5 has come out as have other \"next generation\" bundlers like [Parcel][2], [Snowpack][3], and [Vite][4]. They promise some combination of faster builds, smaller bundles, and easier configuration. All good things! But while the payoff\u002Fpain tipping may come soon,  I'm not yet there. Maybe there'll be a personal project to test the waters.\n\nOne thing, however, that has really eased the pain and opened vistas recently is setting up continuous deployment. That may mean different things to different people, but in my work it means connecting one or more workflow environments directly to repository branches and setting up automatic builds so that those deployed environments always match the current codebase.\n\nAt Pew, for instance, I set the deployed GitHub pages version of a project to always match the `preview` branch of a repo. I can share that link with coworkers and always be sure what they see there is up to date simply by pushing `preview` to GitHub. This is made possible by GitHub actions and adding a `node.js.yml` file to the `.github\u002Fworkflows\u002F` directory of the repo.\n\nDeploying my front-end Pew work to production isn't so simple unfortunately and is not automated. The features I make have to be embedded in a page of the website and that is handled manually in the site's CMS.\n\nFor other work, though, I do have more automated workflows with AWS in one case and Microsoft Azure in another. MS Azure is home to the serverless back end for an upcoming Pew project's database and NodeJS functions. I have continuous deployment set up there so that Azure automatically builds and deploys any push to the `stage` branch of the repo. Deploying directly to production is warned against so I instead follow Azure's recommendation of \"swapping\" slots of the serverless functions. Push to `stage`, allow the automatic build to happen, and then swap the production slot for the stage slot. This ensures that the update is made smoothly and that the instance is still hot, should people be visiting the site at the time the swap is made.\n\nAWS is home to a side project on the energy efficiency of properties throughout the service areas of certain power companies. There's a lot going on there: S3 buckets for static files, Cognito for user authentication, Pinpoint for sending SMS message, some Lambdas, and more. The app itself is hosted in AWS Amplify, which has pretty easy (at least by AWS standards!) configuration for continuous deployment. The site has two live environments: dev and production. Any push to the `dev` branch triggers a build to the dev environment; pushing to `main` triggers production.\n\nOther, larger teams (larger than this team of one), can get more sophisticated with their continuous deployment and the other aspects of CI\u002FCD (continuous development, continuous integration). They can automate tests and merges and remove even more of the repetitive and painstaking tasks of deploying code to the web. But even small steps in that direction can make a big differenceâ€”and a happier developer.\n\n[1]: https:\u002F\u002Fv4.webpack.js.org\u002F\n[2]: https:\u002F\u002Fparceljs.org\u002F\n[3]: https:\u002F\u002Fwww.snowpack.dev\u002F\n[4]: https:\u002F\u002Fvitejs.dev\u002F\n",snippet:"Setting up continuous deployment can really ease the pain of web development. ",tags:[{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"2XOafKDP6dUEgVL2ao5Q5Z",type:g,createdAt:Q,updatedAt:Q,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f},fields:{tag:"devops"}}],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"2QrCTloGZjWVsyOwrVwgDZ",type:l,createdAt:R,updatedAt:R,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:q,revision:i,locale:f},fields:{title:"eric-muhr-u49bj3nOPD8-unsplash",file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F2QrCTloGZjWVsyOwrVwgDZ\u002F961743c8415161647c883d09c5d9dcb0\u002Feric-muhr-u49bj3nOPD8-unsplash.jpg",details:{size:704448,image:{width:2400,height:1600}},fileName:"eric-muhr-u49bj3nOPD8-unsplash.jpg",contentType:t}}}}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"1oyadfQd8N6WkaeS0WnBtr",type:g,createdAt:"2022-08-15T17:07:44.262Z",updatedAt:"2022-08-15T17:09:47.058Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:21,revision:j,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"How do you spell propagation?",datePublished:"2021-08-12",body:"\n\u003Cspan style=\"float:none;\" class=\"first-letter\"\u003EP-R-O-P-A-G-A-T-I-O-N\u003C\u002Fspan\u003E\n\nAs in `Event.stopPropagation()`.\n\n\u003Cdel\u003Epropogation\u003C\u002Fdel\u003E \n[MDN](https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FAPI\u002FEvent\u002FstopPropagation)\n",snippet:"One of the things I look up all the time: how to spell \"propagation.\"",tags:[S],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"2O4PgpZEqVVdyOX60nMVmn",type:l,createdAt:U,updatedAt:U,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:u,revision:i,locale:f},fields:{title:"the letters of propagation",description:o,file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F2O4PgpZEqVVdyOX60nMVmn\u002Fe9952e60e07a58d5a1e2a6350485b969\u002Fpropagation.png",details:{size:55552,image:{width:1711,height:1208}},fileName:"propagation.png",contentType:p}}}}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"7fYziFOPSJual3G94badmz",type:g,createdAt:"2022-08-14T21:00:02.690Z",updatedAt:"2022-08-26T17:07:35.578Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:39,revision:V,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"How I make using Mapbox easier, part two: accessing data with dummy features",datePublished:"2021-01-03",body:"As I've [said before](\u002Fcontent\u002Fhow-i-make-using-mapbox-easier-part-one-async-adding-sources-and-layers\u002F), I really like using Mapbox for visualizing geographic data, but it does have a few things I stumble over again and again. One of those things is trying to access the entirety of a dataset that's behind map features that have not fully rendered. I'll explain what I mean about that in a moment; one of the solutions I've found, to cut to the chase, is to preprocess the data I need and attach it to a dummy feature that I know will render when the map loads.\n\n![mapbox dummy area](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F7BVY3VwnWJTM90HvIZbgqG\u002Fcbf88c45ce1baae670b4133954c2212c\u002Fmapbox-dummy-feature.png)\n\n## Some explanation\nThere are basically two ways to supply the data you are visualizing to Mapbox: 1) you can do it when your code is executed by supplying the Map instance's `addSource()` method with geoJSON data, whether literally (i.e., passing the geoJSON object directly), by reference, or by supplying a url to it or 2) you can supply the data beforehand, behind the scenes, by uploading data to Mapbox Studio or using its tiling service. When you supply the data beforehand, Mapbox converts it into a tileset, a collection of data ready to be loaded into a map at a range of zoom levels. When you `addSource()` to the map, you point instead to the ready-made tileset. (You can also upload the data to Mapbox Studio as a dataset, which you can later convert to tilesets.)\n\nI prefer to upload or tile-service the data beforehand rather than handle potentially very large geoJSON objects client-side and expend the resources and milliseconds (or seconds) needed to convert that data into tiles on every page load, every time someone visits the page. If the data is static, why task each client with performing those operations over and over again?\n\n## The problem\nIf you're only rendering features on a map and only displaying or inspecting or otherwise making use of the data properties of those features after they are renderedâ€”for example, by clicking or hovering over locationsâ€”the above method of not handling the data client-side will be fine. But if you would like to also display data beyond the context of the map, such as summary stats or graphs in a sidebar, you will likely find that you don't have access to all the data points in the tileset because not all of the features have been rendered. Features may be outside the current bounds of the map, or they may be too densely packed to show at your current zoom level. So if you wanted to, for example, display a bar chart showing the number of the various kinds of, say, donut shops in your city, you would not reliably be able to get the full dataset using the [`queryRenderedFeatures()`](https:\u002F\u002Fdocs.mapbox.com\u002Fmapbox-gl-js\u002Fapi\u002Fmap\u002F#map#queryrenderedfeatures) method. \n\n## One harder solution\nThere is a viable way to use the [`querySourceFeatures()`](https:\u002F\u002Fdocs.mapbox.com\u002Fmapbox-gl-js\u002Fapi\u002Fmap\u002F#map#queryrenderedfeatures) method, which returns source data regardless of whether it has been rendered, but you have to manage two difficulties: data behind tiles outside the bounds of your current map viewport will not be returned and the same data may be returned more than once if the feature it's attached to spans multiple tiles.\n\nI've managed that solution for a project [mapping flood insurance programs](\u002Fcontent\u002Fmapping-data-from-the-national-flood-insurance-program\u002F) where the sidebar graphs were meant to update to always include only data for features within the current maps bounds. If your graphs don't need to adjust according to the map bounds, there are easier ways.\n\n## Easier solutions\nOne solution is to provide the full dataset to Mapbox for rendering features on the map and keep the same dataset client-side for other purposes. That doesn't sit wellâ€”you've got two sources of truth and are using up system resources unnecessarily. Another option is to keep only a preprocessed summary of the data client-side. That's fine; I've done it this way and probably will again. The heavy work of manipulating the data is done once during a build or prebuild step, so at least you're sparing the client from doing the same, repetitive data manipulation over and over again. That still gives you two sources of truth, though, and a somewhat more complex thing to maintain or update.\n\nTo keep all the dataâ€”the summary and its sourceâ€”together, you can attach the summary data to a dummy feature in the tileset. A tileset of polygons scattered throughout a geographical area, for instance, could have a dummy polygon, the size of your map bounds, with the summary data attached to it as the feature's properties. Adjust its opacity to zero using a data-driven expression and there you have it. Whenever you have to update the data, you have it all in one source.\n\nIf your tileset is of points, you'll have to put the summary data in its own polygon tileset so that it can cover an area large enough to ensure that it is rendered on map load. That's not as clean but at least with everything coming as a tileset you won't be juggling multiple ways of serving up the data. Grab it with `queryRenderedFeatures()`, and you're good to go.\n\nThanks as always for reading. If I've missed something or got it wrong, please let me know.",snippet:"Accessing the entire dataset behind a Mapbox layer is hard; attach data to a dummy feature and use that instead.",tags:[w,X],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"7BVY3VwnWJTM90HvIZbgqG",type:l,createdAt:Z,updatedAt:Z,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:s,revision:i,locale:f},fields:{title:"mapbox dummy area",description:o,file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F7BVY3VwnWJTM90HvIZbgqG\u002Fcbf88c45ce1baae670b4133954c2212c\u002Fmapbox-dummy-feature.png",details:{size:225524,image:{width:x,height:y}},fileName:"mapbox-dummy-feature.png",contentType:p}}}}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"6V9Xr8BggyQQpVgahElTkA",type:g,createdAt:"2022-08-14T21:12:52.768Z",updatedAt:"2022-08-16T15:05:33.526Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:51,revision:V,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"How I make using Mapbox easier, part one: async adding sources and layers",datePublished:"2020-12-29",body:"\nMapbox (specifically, for me, [Mapbox GL JS][1]) is a great platform for visualizing geographic data. I like that their documentation is thorough (though not always easy to digest). I like that they seem to have invested a lot of effort into making it a useful dataviz tool, in addition to all its other uses: navigation, geocoding, augmented vision. I like that they're headquartered here in DC. And I like that their pricing plans have a meaningful and useful free tier.\n\nAwesome.\n\nOver the three or four years I've been using it, though, I have come up against the same challenges. One is the difficulty of its expressions syntax for data-driven styling or interpolated values, which I have to look up every time. Another is accessing the full data behind map features that may not be fully rendered. Anotherâ€”the topic of this postâ€”is how to work with the async nature of adding sources and layers to a map.\n\n![a mapbox view of San Diego with red, orange, and purple extruded recangles representing buildings on a dark background][2]\n\nAdding sources and layers to a Mapbox map is pretty straightforward. The source is the data, and the layer is a visualization of the data. You can have multiple layers based on the same data. To [add a source][3], you use the `addSource()` method of the Map instance. It takes an `id` string and a config object as parameters. The underlying data can be geoJSON, or a vector source already uploaded to Mapbox, or others like raster images or video. To [add a layer][4], you use the `addLayer()` method, which takes a config object and, optionally, the name of another layer to insert the new layer before.\n\nThe trouble is your code may quite easily call the `addLayer()` method\nbefore `addSource()` really takes effect. Both methods are quietly asynchronous, handled by Mapbox outside the written sequence of your code. Mapbox could, perhaps should, make those methods explicitly async or, in other words, make them Promises that resolve only after they have taken full effect. In fact, in this [Github issue][5], it looks like that may be in the works.\n\nIn the meantime, it simply takes time for `addSource()` and `addLayer()` to take effect, which means you have to ensure the map layers are ready before you try to do anything with them. My solution has been to wrap the native methods in my own Promises that test whether the layers are rendered before resolving. This way, I can add a source, add some layers, and then chain my next actions via `then()`.\n\nThat solution is available as a small npm package, [mapbox-helper][6]. Give it a try. More info about how it works and how to use it is available there. The short version is this: the native `addSource()` and `addLayer()` methods are combined into one, `addSourceAndLayers()`, in which you specify the source you want to add and one or more layers that are based on it. Internally, adding the layers only occurs after the source is ready. The method returns a Promise to your code that resolves only after all layers have been rendered or, if a layer's visibility property is set to 'none', is ready to be rendered.\n\nFor example:\n\n\u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fostermanj\u002Fc8302e49e9b83b83a05bd2e964d92fba\" class=\"embedly-card\" data-card-width=\"100%\" data-card-controls=\"0\"\u003EEmbedded content: https:\u002F\u002Fgist.github.com\u002Fostermanj\u002Fc8302e49e9b83b83a05bd2e964d92fba\u003C\u002Fa\u003E\n\nThanks for reading. And, by the way, if you haven't checked out Mapbox's [version 2 release yet][7], you should. It has really great 3D rendering of elevation data and super hi-res satellite imagery, among other performance improvements.\n\n[1]: https:\u002F\u002Fdocs.mapbox.com\u002Fmapbox-gl-js\u002Fapi\u002F\n[2]: \u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F3KfGz5kmTI4dkz0l98oHY3\u002F777fd2648aaab56363a79c818dc3d1c2\u002Fmapbox.png\n[3]: https:\u002F\u002Fdocs.mapbox.com\u002Fmapbox-gl-js\u002Fapi\u002Fsources\u002F\n[4]: https:\u002F\u002Fdocs.mapbox.com\u002Fmapbox-gl-js\u002Fapi\u002Fmap\u002F#map#addlayer\n[5]: https:\u002F\u002Fgithub.com\u002Fmapbox\u002Fmapbox-gl-js\u002Fissues\u002F10192\n[6]: https:\u002F\u002Fwww.npmjs.com\u002Fpackage\u002Fmapbox-helper\n[7]: https:\u002F\u002Fwww.mapbox.com\u002Fblog\u002Fmapbox-gl-js-v2-3d-maps-camera-api-sky-api-launch",snippet:"Use a small npm package to work with the async nature of adding sources and layers to a Mapbox map.",tags:[X,w],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"3KfGz5kmTI4dkz0l98oHY3",type:l,createdAt:_,updatedAt:_,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:s,revision:i,locale:f},fields:{title:"mapbox async layers",description:o,file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F3KfGz5kmTI4dkz0l98oHY3\u002F777fd2648aaab56363a79c818dc3d1c2\u002Fmapbox.png",details:{size:774983,image:{width:x,height:y}},fileName:"mapbox.png",contentType:p}}}}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"14Dv4JCMRb1ktoKjtKho9Z",type:g,createdAt:"2022-08-15T16:56:08.179Z",updatedAt:"2022-08-15T17:06:40.205Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:24,revision:q,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"Is viewBox camelCased?",datePublished:"2020-10-02",body:"\u003Cspan style=\"float:none;\" class=\"first-letter\"\u003EYES\u003C\u002Fspan\u003E\n\nAs in SVG viewBox attribute.\n\n\u003Cdel\u003Eviewbox\u003C\u002Fdel\u003E \n[MDN](https:\u002F\u002Fdeveloper.mozilla.org\u002Fen-US\u002Fdocs\u002FWeb\u002FSVG\u002FAttribute\u002FviewBox)\n\n![a single-humped camel in the desert](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F3I6Ln0CCEBofYIytHxNbun\u002F0a3c21ddd73b4cb1ab0ea5b7094a642d\u002Fcamel.jpg)",snippet:"One of the things I look up all the time: viewbox or viewBox?",tags:[S],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"3I6Ln0CCEBofYIytHxNbun",type:l,createdAt:$,updatedAt:$,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:u,revision:i,locale:f},fields:{title:"a single-humped camel in the desert",description:o,file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F3I6Ln0CCEBofYIytHxNbun\u002F0a3c21ddd73b4cb1ab0ea5b7094a642d\u002Fcamel.jpg",details:{size:52282,image:{width:x,height:y}},fileName:"camel.jpg",contentType:t}}}}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"6T6pjbF8hfxS96NPLUmT0a",type:g,createdAt:"2022-08-16T19:13:02.066Z",updatedAt:"2022-08-26T17:09:19.385Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:32,revision:q,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"Four questions to ask about your data visualization",datePublished:"2016-11-30",body:"If charts and data visualizations are part of your content strategy, you know there's a ton of advice out there about how to do them well. At the very least, you should ask yourself four questions about \"the AIMS\" of each piece.\n\n1. Is it accurate?\n2. Is it intuitive?\n3. Is it memorable?\n4. Is it self-contained? \n\nNow some of the best data visualizations won't have positive answers to all of these questions, and that's fine (one hopes #1 and #3 are always yeses). But if your data viz is meant to convincingly convey a message, meeting these four criteria will help it do so quickly and effectively. \n\n## Is it accurate?\n\nStep one is to make data visualizations that faithfully represent the data. The value of that statement shouldn't need explanation, but it's very easy through intentional or unintentional design decisions to degrade a chart's accuracy. \n\nAn accurate chart should tell the truth, the whole truth, and nothing but the truth.\n\nDon't let embellishments or unnecessary effects take away from (or add to) your charts.\n\n**Rule-breaker #1, [from copyhackers.com](https:\u002F\u002Fcopyhackers.com\u002F2016\u002F02\u002Fshort-long-content\u002F):**\n\n![a bar chart with 3D effects and a truncated y-axis](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F6m6vt8r1CtNFR6BWBbr9bJ\u002F2260c37ce51686f3ab2ba23abc1f5d42\u002Fcopyhackers-chart.png)\n\nThe 3D effect obscures what the precise values are. The truncated y-axis (min value = 90) exaggerates the difference between the two values. And there's little need to visualize two values anyway.\n\n**Better:** a bar chart with a zero-based axis and no 3D effects, or no chart at all. \n\n## Is it intuitive?\n\nIntuitive charts have visual elements that immediately match the main message by making use of established conventions or primary visual metaphors.\n\nThe example below from the World Bank has a lot going for it, but there's dissonance between the title's message of growth and the primary visual of flat lines. We expect to see something going up. By bucking some fundamental conventions and primary visual metaphors (e.g., that size is usually represented vertically and time horizontally), the chart requires additional effort to understand. \n\n**Rule-breaker #2, [from the World Bank](http:\u002F\u002Fblogs.worldbank.org\u002Fopendata\u002Fchart-25-years-growth-worlds-largest-cities):**\n\n![a nonintuitive chart](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F1ZXhv1zTczozoybaz1a9Oo\u002Feb548653481c104c4eb7d2db8154cf35\u002Fworld-bank-chart.png)\n\nFlat lines not intuitive for notion of growth. We expect time to be along the horizontal axis. The colors selected for the years are also counterintuitive. The movement in time from dark dots to light dots also bucks expectations. Light to dark would be more intuitive.\n\n**Better:** A line chart or [slope graph](http:\u002F\u002Fwww.visualisingdata.com\u002F2013\u002F12\u002Fin-praise-of-slopegraphs\u002F) are good candidates. With the emphasis being the difference between two endpoints and not all the values in between, a slope graph would be best.\n\n## Is it memorable?\n\nTo be intuitive, we use conventions. To be accurate (and nothing but accurate), we strip out the superfluous. But it turns out that [visualizations with more \"chart junk\" (like illustrations and other nondata elements) are more memorable](http:\u002F\u002Fhci.usask.ca\u002Fpublications\u002Fview.php?id=173). \n\nIt makes sense that unusual elements would make a chart more memorable, but how can you embrace being memorable without compromising the other aspects of effective data visualization?\n\nI wouldn't reach too quickly for the clip art or brazen illustrations. Consider instead using small icons to help illustrate your data and, at the very least, make sure your charts are consistent with your brand's style so that people are more likely to remember where they saw it. The chart below would benefit from both.\n\n**Rule-breaker #3, [from the Peterson Institute for International Economics](https:\u002F\u002Fpiie.com\u002Fblogs\u002Fchina-economic-watch\u002Ftracking-chinas-service-sector):**\n\n![a nonmemorable chart](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F1PHqAcYy43rhncqWkUbErb\u002F164fd84fb882cae73d80bbbdbca9939f\u002Fpeterson-chart.png)\n\nDefault fonts. Minimal branding. Not memorable.\n\n**Better:** Small icons for highway, railway, and air transport would help make this chart more memorable, and identify the lines more quickly than the legend. Brand colors are present, but brand-appropriate typeface and a logo would help it linger in the mind longer.\n\n## Is it self-contained?\n\nSelf-contained data visualizations convey their main messages quickly even when they're separated from their original contexts. This is good for two reasons: first, many of your readers are [only scanning what you write](\u002Fblog\u002F2016\u002F11\u002F09\u002Fwriting-web-embrace-skimming-scanning\u002F) and won't get much from charts and graphics that don't quickly convey messages on their own. That's a missed opportunity to get your point across.\n\nSecond, self-contained data visualizations are ready for posting on social media or as standalone content on your website. From one blog with three charts, for example, you get four pieces of content with no additional work.\n\nHow to make a chart self-contained depends on the information being conveyed, but the cardinal rule is this:\n\n**The chart's title should be a statement of the main message.**\n\nIf you can build the chart to the dimensions used by various social media (roughly 2:1 for Facebook, Twitter, and LinkedIn), even betterâ€”it'll look great on your website and in my Twitter feed.\n\n**Rule-breaker #4, from [Resources for the Future](http:\u002F\u002Fwww.rff.org\u002Fresearch\u002Fpublications\u002Ften-recommendations-plugging-gaps-inactive-well-policy):**\n\n![a non-self-contained chart](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F4FGYBguYDbcMPVU92CWm5J\u002F05886997ca5bbb35d45cbabb554a0fad\u002Frff-chart.png)\n\nGood dimensions for social media, but not self contained.\n\nWithout the context we lose sight of what the chart is about (spent oil wells) and the main points: that while Alaska's and North Dakota's regulations are more stringent that the Bureau of Land Management's,  \"no state is regulating all five elements [of ensuring the safety of spent oil wells] the most stringent way.\" \n\n**Better:** A new titleâ€”**&ldquo;Two states outperform the Bureau of Land Management but regulation of spent oil wells is poor overall,\"** or something similar. With that, the chart would communication much more quickly and be able to stand on its own on social media and elsewhere.",snippet:"There's a ton of advice out there about how to do data viz well. At the very least, you should ask yourself four questions about \"the AIMS\" of each piece.\n",tags:[w,aa],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"3Kiq3srjOCqF7HCSiNvC3H",type:l,createdAt:ac,updatedAt:ac,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:J,revision:i,locale:f},fields:{title:"line chart and bar chart icons with text: is it accurate? is it intuitive? is it memorable? is it self-contained?",description:o,file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F3Kiq3srjOCqF7HCSiNvC3H\u002F94f0dc6be6bc9dfb79cbb03fe671a5a9\u002Fcharts-image.png",details:{size:6582,image:{width:ad,height:ae}},fileName:"charts-image.png",contentType:p}}}}},{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"1yLbt9rKCj16qyMnEL167C",type:g,createdAt:"2022-08-15T16:47:08.553Z",updatedAt:"2022-10-23T00:39:23.776Z",environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:P,revision:q,contentType:{sys:{type:a,linkType:h,id:k}},locale:f},fields:{authors:[m],title:"Writing for the web: why you should encourage skimming and scanning",datePublished:"2016-11-09",body:"People donâ€™t read online so much as they skim and scan, and unless your content is crafted with that in mind, your readers are going to jump ship.\n\nThereâ€™s nothing new in this observation. Jakob Nielsenâ€™s research [demonstrated it back in 1997][link to Nielsen], and his findings hold up nearly 20 years later. Readers scan webpages, looking for keywords and main points. If you think about how you read on the web (and are honest with yourself), youâ€™ll probably find the same is true for you. So while you may wish your content was being read word by word, itâ€™s time to accept that it isnâ€™t.\n\nEven if you hate the skim, you should love the skimmer.\n\n## How to write for scanning\n\nLong paragraphs of unchanging text are difficult to scan and will turn many potential readers away. Here are a few editorial ways (not much different from Nielsenâ€™s 1997 advice) to make your content more scannable:\n\n- get to the point immediately with a journalistic style of writing\n- use short paragraphs, with one idea each\n- use subheadings\n- use bulleted lists (but not too much)\n- highlight words with bold type or links (but not too much)\n\nRemember: if everything is highlighted (or bulleted), nothing is. A brief that simply outlines an entire report, for instance, is neither easy to read nor easy to skim. Donâ€™t overdo it.\n\n![stylized image of two documents, one easy to read with bold text and bullets and the other hard to skim, just text](\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F7p3s5Q4QkAFnKnE8hj9b5N\u002Fbd34e988ac10d404b7aaa87a1768e747\u002Fweb-writing-scan.png)\n\n## Why write for scanning?\n\nYou may be thinking that your target audience are the people who *will* take the time to read your content carefully. Why should you care about the others? First, if your writing easy to scan, more of your audience will get something out of it. Even the fastest scanner might recommend your page to a friend or colleague, or tweet, sign a petition, or take another action.\n\nSecond, **scanning is a how we decide whether we want to read**. This is one of the main differences between reading online and reading in print. With print, we decide we want to read when we pick up a book or magazine. Online, we begin looking at a page before weâ€™ve decided whether to read it,  and we have to be convinced in that moment to read instead of navigating somewhere else on the web. The more scannable a page is, the easier that decision is to make, and the easier it is to read.\n\nIf you love your skimmers, your readers will love you back.\n\n[link to Nielsen]:https:\u002F\u002Fwww.nngroup.com\u002Farticles\u002Fhow-users-read-on-the-web\u002F",snippet:"Reading online usually involves a lot of skimming and scanning. Embrace it.",tags:[aa,{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"3fDaOPEuuiHXi1QZFse17z",type:g,createdAt:af,updatedAt:af,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:j,revision:i,contentType:{sys:{type:a,linkType:h,id:n}},locale:f},fields:{tag:"writing + editing"}}],heroImage:{metadata:{tags:[],concepts:[]},sys:{space:{sys:{type:a,linkType:b,id:c}},id:"7p3s5Q4QkAFnKnE8hj9b5N",type:l,createdAt:ag,updatedAt:ag,environment:{sys:{id:d,type:a,linkType:e}},publishedVersion:v,revision:i,locale:f},fields:{title:"web-writing-scan",file:{url:"\u002F\u002Fimages.ctfassets.net\u002F3qr5d6sj491p\u002F7p3s5Q4QkAFnKnE8hj9b5N\u002Fbd34e988ac10d404b7aaa87a1768e747\u002Fweb-writing-scan.png",details:{size:2864,image:{width:ad,height:ae}},fileName:"web-writing-scan.png",contentType:p}}},slug:"writing-for-the-web-why-you-should-encourage-skimming-and-scanning"}}],limit:100,total:11},uses:{dependencies:z,params:["type"],parent:z,url:z}}]}}("Link","Space","3qr5d6sj491p","master","Environment","en-US","Entry","ContentType",1,2,"blogPost","Asset",{},"tag","","image\u002Fpng",3,1024,5,"image\u002Fjpeg",6,4,{},1014,716,void 0,"data",null,"2022-06-25T01:06:08.949Z",{},"2023-06-27T01:32:31.748Z",{},"2023-01-12T17:37:01.886Z","2024-01-02T16:09:40.691Z","2023-06-27T01:33:22.191Z",13,"2023-01-12T17:37:15.869Z","2023-01-13T01:48:42.934Z","2022-08-31T00:21:59.214Z","2022-08-31T00:22:13.028Z","2022-08-31T00:26:23.277Z",33,"2022-06-25T01:16:22.342Z","2022-06-25T01:17:29.087Z",{},"2022-08-15T16:54:05.821Z","2022-08-15T17:00:14.394Z",10,"2022-07-25T18:21:18.957Z",{},"2022-08-14T20:57:53.919Z","2022-08-14T20:59:17.771Z","2022-08-14T21:09:00.907Z","2022-08-15T16:55:20.046Z",{},"2022-08-15T16:42:21.776Z","2022-08-16T19:12:49.356Z",696,364,"2022-08-15T16:42:41.142Z","2022-08-15T16:44:59.600Z"))